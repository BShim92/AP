<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Advantage Slot Quick Check</title>
  <style>
    :root{
      font-family:-apple-system,system-ui,Segoe UI,Roboto,Arial;
      color-scheme: light;
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      background:#f6f7fb;
      color:#0b0f18;
    }

    /* ===== Top compact game switcher (small + 2 rows) ===== */
    .topbar{
      position:sticky; top:0; z-index:999;
      background:rgba(246,247,251,.92);
      backdrop-filter: blur(10px);
      border-bottom:1px solid rgba(0,0,0,.08);
      padding:8px 10px 6px;
    }
    .chips{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
      align-items:center;
      justify-content:flex-start;
      max-width:980px;
      margin:0 auto;
    }
    .chip{
      border:1px solid rgba(0,0,0,.12);
      background:#ffffff;
      border-radius:999px;
      padding:6px 10px;
      font-weight:850;
      font-size:12px;
      line-height:1;
      cursor:pointer;
      user-select:none;
      box-shadow:0 1px 0 rgba(0,0,0,.03);
      white-space:nowrap;
    }
    .chip[aria-selected="true"]{
      border-color: rgba(0,0,0,.22);
      box-shadow: 0 6px 16px rgba(0,0,0,.08);
    }

    /* ===== Page container ===== */
    .wrap{
      max-width:980px;
      margin:0 auto;
      padding:10px;
    }

    .game{
      display:none;
      gap:10px;
      padding-bottom: calc(16px + env(safe-area-inset-bottom));
    }
    .game.active{ display:block; }

    /* ===== Light panels ===== */
    .grid2{
      display:grid;
      grid-template-columns: 1fr 1.05fr;
      gap:10px;
      align-items:start;
    }
    @media (max-width: 720px){
      .grid2{ grid-template-columns: 1fr; }
    }

    .panel{
      border:1px solid rgba(0,0,0,.10);
      background:#ffffff;
      border-radius:14px;
      padding:10px;
      box-shadow: 0 10px 30px rgba(0,0,0,.06);
    }
    .panelTitle{
      font-weight:950;
      letter-spacing:.4px;
      font-size:11px;
      opacity:.7;
      margin:0 0 10px;
      text-transform:uppercase;
    }

    /* ===== Inputs ===== */
    .field{
      display:flex;
      gap:8px;
      align-items:center;
    }
    .label{
      font-weight:900;
      font-size:13px;
      white-space:nowrap;
    }
    .sub{
      font-weight:800;
      font-size:11px;
      opacity:.65;
    }
    input[type="number"], input[type="text"], select{
      width:100%;
      border:1px solid rgba(0,0,0,.14);
      border-radius:12px;
      padding:12px 12px;
      font-size:16px;
      font-weight:900;
      background:#fff;
      color:#0b0f18;
      outline:none;
    }
    input::placeholder{ color: rgba(11,15,24,.35); font-weight:800; }

    /* ===== Result bar ===== */
    .result{
      border:1px solid rgba(0,0,0,.10);
      border-radius:14px;
      padding:12px 12px;
      font-weight:950;
      font-size:18px;
      text-align:center;
      user-select:none;
      background:#ffffff;
      color:#0b0f18;
    }
    .r-white{ background:#ffffff; }
    .r-red{ background:#ff5a5a; }
    .r-orange{ background:#ffb34d; }
    .r-yellow{ background:#ffe066; }
    .r-green{ background:#67d36b; }

    /* ===== Small helper buttons ===== */
    .miniBtns{
      display:flex;
      gap:8px;
      margin-top:10px;
      align-items:center;
      flex-wrap:wrap;
    }
    .miniBtn{
      border:1px solid rgba(0,0,0,.12);
      background:#fff;
      border-radius:12px;
      padding:10px 12px;
      font-size:13px;
      font-weight:950;
      cursor:pointer;
      user-select:none;
      box-shadow: 0 6px 16px rgba(0,0,0,.06);
    }
    .miniBtn:active{ transform: translateY(1px); }

    .hint{
      margin-top:10px;
      font-size:12px;
      line-height:1.25;
      opacity:.75;
    }
    .mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-weight:900; }

    /* ===== Temple Falls row grid ===== */
    .tfRows{
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .tfRow{
      display:grid;
      grid-template-columns: repeat(5, 1fr) .9fr;
      gap:8px;
      align-items:stretch;
    }
    .tfCell{
      border-radius:12px;
      border:1px solid rgba(0,0,0,.10);
      background:#d9f2ff;
      padding:6px;
      display:flex;
      align-items:flex-end;
      min-height:56px;
      transition: background 120ms ease;
    }
    .tfCell.rainbow{
      background: linear-gradient(90deg,#ff5a5a,#ffb34d,#ffe066,#67d36b,#59c6ff,#9b6bff,#ff5ad9);
    }
    .tfIn{
      width:100%;
      border:1px solid rgba(0,0,0,.14);
      border-radius:10px;
      padding:10px 10px;
      font-size:16px;
      font-weight:900;
      background: rgba(255,255,255,.92);
    }
    .tfTotal{
      border-radius:12px;
      border:1px solid rgba(0,0,0,.10);
      background:#f2f3f7;
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:950;
      font-size:15px;
      min-height:56px;
      user-select:none;
    }

    /* Floating dot (Temple Falls) */
    .fab{
      position:fixed;
      right: 14px;
      bottom: calc(90px + env(safe-area-inset-bottom));
      z-index: 99999;
    }
    .fab button{
      border:1px solid rgba(0,0,0,.14);
      background:#fff;
      border-radius:14px;
      padding:12px 14px;
      font-size:18px;
      font-weight:950;
      cursor:pointer;
      box-shadow: 0 10px 26px rgba(0,0,0,.12);
    }

    /* ===== Frankenstein grid ===== */
    .fGrid{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:8px;
    }
    .fCell{
      position:relative;
      border-radius:12px;
      border:1px solid rgba(0,0,0,.10);
      min-height:68px;
      padding:28px 6px 6px;
      display:flex;
      align-items:flex-end;
      background:#eef2ff;
    }
    .fRed{ background:#ffe3e3; }
    .fBlue{ background:#e3f4ff; }

    .w{
      position:absolute;
      top:6px; left:6px;
      font-size:10px;
      font-weight:950;
      padding:2px 6px;
      border-radius:999px;
      background: rgba(255,255,255,.85);
      border:1px solid rgba(0,0,0,.10);
      pointer-events:none;
    }
    .fIn{
      width:100%;
      border:1px solid rgba(0,0,0,.14);
      border-radius:10px;
      padding:10px 10px;
      font-size:16px;
      font-weight:900;
      background: rgba(255,255,255,.90);
    }

    /* ===== Simple 3-field colored list (Regal) ===== */
    .vStack{ display:flex; flex-direction:column; gap:10px; }
    .colorRow{
      display:grid;
      grid-template-columns: 1fr 1.3fr;
      gap:10px;
      align-items:center;
      border:1px solid rgba(0,0,0,.10);
      border-radius:14px;
      padding:10px;
      background:#fff;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-weight:950;
      font-size:14px;
    }
    .dot{
      width:12px; height:12px; border-radius:999px;
      border:1px solid rgba(0,0,0,.10);
      display:inline-block;
    }
    .dot.yellow{ background:#ffe066; }
    .dot.green{ background:#67d36b; }
    .dot.purple{ background:#9b6bff; }

    /* ===== Golden Jungle columns row ===== */
    .gjRow{
      display:grid;
      grid-template-columns: repeat(5, 1fr);
      gap:8px;
    }
    .gjCell{
      border:1px solid rgba(0,0,0,.10);
      border-radius:14px;
      background:#fff;
      padding:8px;
    }
    .gjCell .label{
      font-size:11px;
      opacity:.65;
      margin-bottom:6px;
    }
    .gjMetrics{
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap:8px;
      margin-top:10px;
    }
    .metric{
      border:1px solid rgba(0,0,0,.10);
      border-radius:14px;
      background:#fff;
      padding:10px;
      text-align:center;
    }
    .metric .k{ font-size:11px; opacity:.65; font-weight:900; }
    .metric .v{ font-size:18px; font-weight:950; margin-top:6px; }
  </style>
</head>

<body>
  <div class="topbar">
    <div class="chips" role="tablist" aria-label="Game switcher">
      <button class="chip" role="tab" aria-selected="true"  data-game="frank">Frankenstein</button>
      <button class="chip" role="tab" aria-selected="false" data-game="temple">Temple Falls</button>
      <button class="chip" role="tab" aria-selected="false" data-game="regal">Regal Riches</button>
      <button class="chip" role="tab" aria-selected="false" data-game="ascend">Ascending / Stack Up</button>
      <button class="chip" role="tab" aria-selected="false" data-game="golden">Golden Jungle</button>
    </div>
  </div>

  <div class="wrap">

    <!-- ====================== Frankenstein ====================== -->
    <section id="game-frank" class="game active" aria-label="Frankenstein">
      <div class="grid2">
        <div class="panel">
          <div class="panelTitle">INPUTS</div>
          <div class="hint">
            Defaults are <b>empty</b>, but each empty field is treated as <span class="mono">1</span> in the total.
            Tap a box, type a number, move on.
          </div>
        </div>

        <div class="panel">
          <div class="panelTitle">GRID</div>

          <div class="fGrid" id="fGrid">
            <!-- Row 1 -->
            <div class="fCell fRed" data-mult="0"><div class="w">0</div></div>

            <div class="fCell fRed" data-mult="0.4">
              <div class="w">0.4</div>
              <input class="fIn" type="number" inputmode="decimal" step="any" placeholder="" />
            </div>

            <div class="fCell fRed" data-mult="1.7">
              <div class="w">1.7</div>
              <input class="fIn" type="number" inputmode="decimal" step="any" placeholder="" />
            </div>

            <!-- Row 2 -->
            <div class="fCell fBlue" data-mult="1.6">
              <div class="w">1.6</div>
              <input class="fIn" type="number" inputmode="decimal" step="any" placeholder="" />
            </div>

            <div class="fCell fBlue" data-mult="2.4">
              <div class="w">2.4</div>
              <input class="fIn" type="number" inputmode="decimal" step="any" placeholder="" />
            </div>

            <div class="fCell fBlue" data-mult="2.0">
              <div class="w">2.0</div>
              <input class="fIn" type="number" inputmode="decimal" step="any" placeholder="" />
            </div>

            <!-- Row 3 -->
            <div class="fCell fBlue" data-mult="1.5">
              <div class="w">1.5</div>
              <input class="fIn" type="number" inputmode="decimal" step="any" placeholder="" />
            </div>

            <div class="fCell fBlue" data-mult="1.25">
              <div class="w">1.25</div>
              <input class="fIn" type="number" inputmode="decimal" step="any" placeholder="" />
            </div>

            <div class="fCell fBlue" data-mult="0.75">
              <div class="w">0.75</div>
              <input class="fIn" type="number" inputmode="decimal" step="any" placeholder="" />
            </div>

            <!-- Row 4 -->
            <div class="fCell fBlue" data-mult="0.75">
              <div class="w">0.75</div>
              <input class="fIn" type="number" inputmode="decimal" step="any" placeholder="" />
            </div>

            <div class="fCell fBlue" data-mult="0.8">
              <div class="w">0.8</div>
              <input class="fIn" type="number" inputmode="decimal" step="any" placeholder="" />
            </div>

            <div class="fCell fBlue" data-mult="0.4">
              <div class="w">0.4</div>
              <input class="fIn" type="number" inputmode="decimal" step="any" placeholder="" />
            </div>
          </div>

          <div style="margin-top:10px;">
            <div id="fResult" class="result r-white">0.00</div>
            <div class="hint">Total uses the multipliers shown in each cell.</div>
          </div>
        </div>
      </div>
    </section>

    <!-- ====================== Temple Falls ====================== -->
    <section id="game-temple" class="game" aria-label="Temple Falls Jungle Adventure">
      <div class="grid2">
        <div class="panel">
          <div class="panelTitle">SETUP</div>
          <div class="field">
            <div class="label">Bet size <span class="sub">(required)</span></div>
          </div>
          <div style="margin-top:8px;">
            <input id="tfBet" type="number" inputmode="decimal" step="any" placeholder="e.g., 8.80" />
          </div>

          <div class="miniBtns">
            <button class="miniBtn" type="button" id="tfAddRow">+ Row (top)</button>
            <button class="miniBtn" type="button" id="tfDot">Insert “.”</button>
          </div>

          <div class="hint">
            Empty cell counts as <span class="mono">1</span>. “.” counts as <span class="mono">38</span>.
            Numbers are treated as raw and divided by bet. Top-added rows don’t count in the bottom total.
          </div>
        </div>

        <div class="panel">
          <div class="panelTitle">GRID</div>
          <div id="tfRows" class="tfRows"></div>

          <div style="margin-top:10px;">
            <div id="tfResult" class="result r-white">0.00</div>
            <div class="hint">Color bands: red &lt; 50, orange &lt; 60, green ≥ 60.</div>
          </div>
        </div>
      </div>

      <div class="fab">
        <button type="button" id="tfDotFab">.</button>
      </div>
    </section>

    <!-- ====================== Regal Riches ====================== -->
    <section id="game-regal" class="game" aria-label="Regal Riches">
      <div class="grid2">
        <div class="panel">
          <div class="panelTitle">INPUTS</div>
          <div class="vStack">
            <div class="colorRow">
              <div class="pill"><span class="dot yellow"></span> Yellow</div>
              <input id="rrYellow" type="number" inputmode="numeric" step="1" placeholder="" />
            </div>
            <div class="colorRow">
              <div class="pill"><span class="dot green"></span> Green</div>
              <input id="rrGreen" type="number" inputmode="numeric" step="1" placeholder="" />
            </div>
            <div class="colorRow">
              <div class="pill"><span class="dot purple"></span> Purple</div>
              <input id="rrPurple" type="number" inputmode="numeric" step="1" placeholder="" />
            </div>
          </div>
          <div class="hint">
            Blue is hidden per your request. This checker uses the same “hard vs soft” idea:
            <b>AP</b> (green) if any value hits hard; <b>Soft</b> (orange) if a value is in soft range.
          </div>
        </div>

        <div class="panel">
          <div class="panelTitle">RESULT</div>
          <div id="rrResult" class="result r-white">Enter values</div>

          <div class="hint">
            Tweak points (in code constants) if you want different hard/soft cutoffs.
          </div>
        </div>
      </div>
    </section>

    <!-- ====================== Ascending Fortunes / Stack Up Pays ====================== -->
    <section id="game-ascend" class="game" aria-label="Ascending Fortunes / Stack Up Pays">
      <div class="grid2">
        <div class="panel">
          <div class="panelTitle">INPUTS</div>

          <div class="vStack">
            <div class="colorRow">
              <div class="pill">Mega <span class="sub">(MHB 350)</span></div>
              <input id="asMega" type="number" inputmode="numeric" step="1" placeholder="" />
            </div>
            <div class="colorRow">
              <div class="pill">Grand <span class="sub">(MHB 250)</span></div>
              <input id="asGrand" type="number" inputmode="numeric" step="1" placeholder="" />
            </div>
            <div class="colorRow">
              <div class="pill">Major <span class="sub">(MHB 200)</span></div>
              <input id="asMajor" type="number" inputmode="numeric" step="1" placeholder="" />
            </div>
            <div class="colorRow">
              <div class="pill">Minor <span class="sub">(MHB 100)</span></div>
              <input id="asMinor" type="number" inputmode="numeric" step="1" placeholder="" />
            </div>
          </div>

          <div class="hint">
            Logic restored to the “away from must-hit-by” rules:
            <span class="mono">Major ≤ 8 away</span>, <span class="mono">Grand ≤ 12 away</span>, <span class="mono">Mega ≤ 20 away</span>.
            Soft combo uses ×1.3: <span class="mono">10 / 15 / 26</span> (any 2 of those 3).
          </div>
        </div>

        <div class="panel">
          <div class="panelTitle">RESULT</div>
          <div id="asResult" class="result r-white">Enter values</div>
          <div class="hint" id="asDetail"></div>
        </div>
      </div>
    </section>

    <!-- ====================== Golden Jungle ====================== -->
    <section id="game-golden" class="game" aria-label="Golden Jungle">
      <div class="grid2">
        <div class="panel">
          <div class="panelTitle">INPUTS</div>

          <div class="field">
            <div class="label">Red spin count</div>
          </div>
          <div style="margin-top:8px;">
            <select id="gjSpin">
              <!-- 10-rollover machine: 0..9 -->
              <option value="0">0</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
              <option value="7">7</option>
              <option value="8">8</option>
              <option value="9">9</option>
            </select>
          </div>

          <div class="hint">
            Columns default to <span class="mono">0</span> and only allow <span class="mono">0 / 1 / 2</span>.
          </div>
        </div>

        <div class="panel">
          <div class="panelTitle">COLUMNS</div>

          <div class="gjRow">
            <div class="gjCell">
              <div class="label">C1</div>
              <select class="gjCol" data-i="0">
                <option value="0" selected>0</option><option value="1">1</option><option value="2">2</option>
              </select>
            </div>
            <div class="gjCell">
              <div class="label">C2</div>
              <select class="gjCol" data-i="1">
                <option value="0" selected>0</option><option value="1">1</option><option value="2">2</option>
              </select>
            </div>
            <div class="gjCell">
              <div class="label">C3</div>
              <select class="gjCol" data-i="2">
                <option value="0" selected>0</option><option value="1">1</option><option value="2">2</option>
              </select>
            </div>
            <div class="gjCell">
              <div class="label">C4</div>
              <select class="gjCol" data-i="3">
                <option value="0" selected>0</option><option value="1">1</option><option value="2">2</option>
              </select>
            </div>
            <div class="gjCell">
              <div class="label">C5</div>
              <select class="gjCol" data-i="4">
                <option value="0" selected>0</option><option value="1">1</option><option value="2">2</option>
              </select>
            </div>
          </div>

          <div class="gjMetrics">
            <div class="metric">
              <div class="k">Total</div>
              <div class="v" id="gjTotal">0</div>
            </div>
            <div class="metric">
              <div class="k"># of “2”</div>
              <div class="v" id="gjTwos">0</div>
            </div>
            <div class="metric">
              <div class="k">Required</div>
              <div class="v" id="gjReq">—</div>
            </div>
          </div>

          <div style="margin-top:10px;">
            <div id="gjResult" class="result r-white">—</div>
            <div class="hint" id="gjDetail"></div>
          </div>
        </div>
      </div>
    </section>

  </div><!-- /wrap -->

<script>
/* ====================== Shared helpers ====================== */
function nOrNull(v){
  const t = String(v ?? "").trim();
  if (t === "") return null;
  const n = Number(t);
  return Number.isFinite(n) ? n : null;
}
function clamp(x, lo, hi){ return Math.max(lo, Math.min(hi, x)); }
function setResult(el, text, cls){
  el.textContent = text;
  el.classList.remove("r-white","r-red","r-orange","r-yellow","r-green");
  el.classList.add(cls);
}

/* ====================== Game switching ====================== */
const chips = Array.from(document.querySelectorAll(".chip"));
const games = {
  frank: document.getElementById("game-frank"),
  temple: document.getElementById("game-temple"),
  regal: document.getElementById("game-regal"),
  ascend: document.getElementById("game-ascend"),
  golden: document.getElementById("game-golden"),
};
function showGame(key){
  for (const k in games) games[k].classList.toggle("active", k === key);
  for (const c of chips) c.setAttribute("aria-selected", c.dataset.game === key ? "true" : "false");
}
chips.forEach(btn => btn.addEventListener("click", () => showGame(btn.dataset.game)));

/* ====================== Frankenstein (EMPTY => 1) ====================== */
(function(){
  const fCells = Array.from(document.querySelectorAll("#fGrid .fCell"));
  const fInputs = Array.from(document.querySelectorAll("#fGrid .fIn"));
  const fResult = document.getElementById("fResult");

  function band(total){
    if (total < 17) return "r-red";
    if (total < 17.5) return "r-orange";
    if (total < 18) return "r-yellow";
    return "r-green";
  }

  function cellVal(inp){
    // empty treated as 1
    const t = String(inp.value ?? "").trim();
    if (t === "") return 1;
    const n = Number(t);
    return Number.isFinite(n) ? n : 1;
  }

  function recalc(){
    let total = 0;
    for (const cell of fCells){
      const mult = Number(cell.dataset.mult || "0");
      const inp = cell.querySelector(".fIn");
      const v = inp ? cellVal(inp) : 0; // top-left has no input
      total += v * mult;
    }
    const out = total.toFixed(2);
    setResult(fResult, out, band(total));
  }

  fInputs.forEach(inp => {
    inp.addEventListener("input", recalc);
    inp.addEventListener("focus", ()=> setTimeout(()=> inp.select?.(), 0));
  });

  recalc();
})();

/* ====================== Temple Falls (Bet + EMPTY => 1) ====================== */
(function(){
  const tfBet = document.getElementById("tfBet");
  const tfRows = document.getElementById("tfRows");
  const tfResult = document.getElementById("tfResult");
  const tfAddRow = document.getElementById("tfAddRow");
  const tfDot = document.getElementById("tfDot");
  const tfDotFab = document.getElementById("tfDotFab");

  const BASE_ROWS = 2;
  let lastFocused = null;

  function parseBet(){
    const n = nOrNull(tfBet.value);
    return (n && n > 0) ? n : null;
  }

  // EMPTY => 1, "." => 38, number => number/bet
  function tfCellValue(raw, bet){
    const s = String(raw ?? "").trim();
    if (s === "") return 1;
    if (s === ".") return 38;
    const n = Number(s);
    if (!Number.isFinite(n)) return 1;
    return n / bet;
  }

  function setCellColor(inp){
    const cell = inp.closest(".tfCell");
    const s = String(inp.value ?? "").trim();

    if (s === "") {
      cell.classList.remove("rainbow");
      cell.style.background = "#d9f2ff";
      return;
    }
    if (s.includes(".")) {
      cell.classList.add("rainbow");
      cell.style.background = "";
      return;
    }
    const n = Number(s);
    if (!Number.isFinite(n)) {
      cell.classList.remove("rainbow");
      cell.style.background = "#d9f2ff";
      return;
    }
    cell.classList.remove("rainbow");
    const v = clamp(n, 1, 200);
    const t = (v - 1) / 199;
    const light = 92 - t * 22;
    cell.style.background = `hsl(45 90% ${light}%)`;
  }

  function band(total){
    if (total < 50) return "r-red";
    if (total < 60) return "r-orange";
    return "r-green";
  }

  function makeRow(included){
    const row = document.createElement("div");
    row.className = "tfRow";
    row.dataset.included = included ? "true" : "false";

    for (let i=0;i<5;i++){
      const cell = document.createElement("div");
      cell.className = "tfCell";

      const inp = document.createElement("input");
      inp.className = "tfIn";
      inp.type = "text";
      inp.setAttribute("inputmode","decimal");
      inp.setAttribute("pattern","[0-9.]*");
      inp.autocorrect = "off";
      inp.spellcheck = false;

      cell.appendChild(inp);
      row.appendChild(cell);

      cell.addEventListener("click", (e)=>{ if (e.target!==inp) inp.focus(); });
      inp.addEventListener("focus", ()=>{ lastFocused = inp; setTimeout(()=> inp.select?.(), 0); });
      inp.addEventListener("input", recalc);
      inp.addEventListener("keydown", (e)=>{
        if (e.key === "Enter"){ e.preventDefault(); focusNext(inp); }
      });
    }

    const total = document.createElement("div");
    total.className = "tfTotal";
    total.textContent = "0.00";
    row.appendChild(total);
    return row;
  }

  function allRows(){ return Array.from(tfRows.querySelectorAll(".tfRow")); }
  function allInputs(){ return Array.from(tfRows.querySelectorAll(".tfIn")); }

  function focusNext(inp){
    const ins = allInputs();
    const idx = ins.indexOf(inp);
    if (idx >= 0 && idx < ins.length - 1) ins[idx+1].focus();
    else inp.blur();
  }

  function init(){
    tfRows.innerHTML = "";
    for (let r=0;r<BASE_ROWS;r++) tfRows.appendChild(makeRow(true));
    recalc();
  }

  function recalc(){
    const bet = parseBet();
    const rows = allRows();
    let bottomTotal = 0;

    for (const row of rows){
      const inputs = Array.from(row.querySelectorAll(".tfIn"));
      inputs.forEach(setCellColor);

      let rowSum = 0;

      if (!bet){
        // bet missing: empties still count as 1, "." counts as 38, numeric treated as 0
        for (const inp of inputs){
          const s = String(inp.value ?? "").trim();
          if (s === "") rowSum += 1;
          else if (s === ".") rowSum += 38;
          else rowSum += 0;
        }
      } else {
        for (const inp of inputs) rowSum += tfCellValue(inp.value, bet);
      }

      row.querySelector(".tfTotal").textContent = rowSum.toFixed(2);
      if (row.dataset.included === "true") bottomTotal += rowSum;
    }

    if (!bet && allInputs().every(i => String(i.value ?? "").trim() === "")){
      setResult(tfResult, "0.00", "r-white");
      return;
    }

    if (!bet){
      setResult(tfResult, bottomTotal.toFixed(2), "r-white");
      return;
    }

    setResult(tfResult, bottomTotal.toFixed(2), band(bottomTotal));
  }

  tfBet.addEventListener("input", recalc);

  tfAddRow.addEventListener("click", ()=>{
    const row = makeRow(false);
    tfRows.prepend(row);
    row.querySelector(".tfIn")?.focus();
    recalc();
  });

  function insertDot(){
    const ins = allInputs();
    if (!ins.length) return;
    let idx = lastFocused ? ins.indexOf(lastFocused) : -1;
    if (idx < 0) idx = 0;
    ins[idx].value = ".";
    recalc();
    focusNext(ins[idx]);
  }

  tfDot.addEventListener("click", insertDot);
  tfDotFab.addEventListener("click", insertDot);

  init();
})();

/* ====================== Regal Riches (restored hard/soft behavior) ====================== */
(function(){
  const yEl = document.getElementById("rrYellow");
  const gEl = document.getElementById("rrGreen");
  const pEl = document.getElementById("rrPurple");
  const out = document.getElementById("rrResult");

  // These were the “good” behaviors you asked for (hard vs soft + callout).
  // If you want different cutoffs later, change these two objects.
  const HARD = { Yellow: 16, Green: 16, Purple: 16 };
  const SOFT = { Yellow: 14, Green: 14, Purple: 14 };

  function read(){
    return {
      Yellow: nOrNull(yEl.value),
      Green:  nOrNull(gEl.value),
      Purple: nOrNull(pEl.value),
    };
  }

  function recalc(){
    const v = read();
    const entries = Object.entries(v).filter(([,n]) => Number.isFinite(n));
    if (!entries.length){
      setResult(out, "Enter values", "r-white");
      return;
    }

    // Hard: any >= HARD[color]
    const hardHits = entries.filter(([k,n]) => n >= HARD[k]);
    if (hardHits.length){
      const [k,n] = hardHits.sort((a,b)=> b[1]-a[1])[0];
      setResult(out, `AP ✅  (${k} = ${n})`, "r-green");
      return;
    }

    // Soft: any >= SOFT[color]
    const softHits = entries.filter(([k,n]) => n >= SOFT[k]);
    if (softHits.length){
      const [k,n] = softHits.sort((a,b)=> b[1]-a[1])[0];
      setResult(out, `Soft ⚠️  (${k} = ${n})`, "r-orange");  // your requested orange + which number
      return;
    }

    setResult(out, "Not in range", "r-red");
  }

  [yEl,gEl,pEl].forEach(el => el.addEventListener("input", recalc));
  recalc();
})();

/* ====================== Ascending Fortunes / Stack Up Pays (restored “away” logic) ====================== */
(function(){
  const megaEl  = document.getElementById("asMega");
  const grandEl = document.getElementById("asGrand");
  const majorEl = document.getElementById("asMajor");
  const minorEl = document.getElementById("asMinor");

  const out = document.getElementById("asResult");
  const detail = document.getElementById("asDetail");

  // Must-hit-by (from the “aka” lines: 192 => MHB 200, 238 => 250, 330 => 350)
  const MHB = { Mega: 350, Grand: 250, Major: 200, Minor: 100 };

  // Hard “away” thresholds (page 5 text)
  const HARD_AWAY = { Mega: 20, Grand: 12, Major: 8, Minor: 4 };

  // Soft (×1.3, rounded down) => 26 / 15 / 10 (+ minor 5)
  const SOFT_AWAY = {
    Mega: Math.floor(HARD_AWAY.Mega  * 1.3),
    Grand:Math.floor(HARD_AWAY.Grand * 1.3),
    Major:Math.floor(HARD_AWAY.Major * 1.3),
    Minor:Math.floor(HARD_AWAY.Minor * 1.3),
  };

  function away(name, val){
    if (!Number.isFinite(val)) return null;
    return MHB[name] - val;
  }

  function recalc(){
    const v = {
      Mega:  nOrNull(megaEl.value),
      Grand: nOrNull(grandEl.value),
      Major: nOrNull(majorEl.value),
      Minor: nOrNull(minorEl.value),
    };

    const any = Object.values(v).some(n => Number.isFinite(n));
    if (!any){
      setResult(out, "Enter values", "r-white");
      detail.textContent = "";
      return;
    }

    const a = {
      Mega:  away("Mega", v.Mega),
      Grand: away("Grand", v.Grand),
      Major: away("Major", v.Major),
      Minor: away("Minor", v.Minor),
    };

    // Hard: any of Mega/Grand/Major within away threshold
    const hardList = ["Major","Grand","Mega"].filter(k => a[k] != null && a[k] <= HARD_AWAY[k]);
    if (hardList.length){
      const k = hardList[0];
      setResult(out, `AP ✅  (${k} is ${a[k]} away)`, "r-green");
      detail.textContent = `Hard thresholds: Major≤8, Grand≤12, Mega≤20.`;
      return;
    }

    // Soft combo: any 2 of {Major, Grand, Mega} within 10/15/26 away
    const softEligible = ["Major","Grand","Mega"].filter(k => a[k] != null && a[k] <= SOFT_AWAY[k]);
    if (softEligible.length >= 2){
      setResult(out, `Soft ✅  (${softEligible.slice(0,2).join(" + ")})`, "r-orange");
      detail.textContent = `Soft combo uses ×1.3: Major≤${SOFT_AWAY.Major}, Grand≤${SOFT_AWAY.Grand}, Mega≤${SOFT_AWAY.Mega}.`;
      return;
    }

    setResult(out, "Not in range", "r-red");
    const parts = ["Major","Grand","Mega"].map(k => (a[k]==null) ? `${k}: —` : `${k}: ${a[k]} away`);
    detail.textContent = parts.join(" • ");
  }

  [megaEl,grandEl,majorEl,minorEl].forEach(el => el.addEventListener("input", recalc));
  recalc();
})();

/* ====================== Golden Jungle (restored live evaluation + dropdowns) ====================== */
(function(){
  const spinEl = document.getElementById("gjSpin");
  const colEls = Array.from(document.querySelectorAll(".gjCol"));
  const totalEl = document.getElementById("gjTotal");
  const twosEl = document.getElementById("gjTwos");
  const reqEl = document.getElementById("gjReq");
  const out = document.getElementById("gjResult");
  const detail = document.getElementById("gjDetail");

  // Practical table (10-rollover): required total tends to drop as you get closer to rollover.
  // If you later want the exact chart numbers, swap this array.
  const REQUIRED_BY_SPIN = [8,8,7,7,6,6,5,5,4,4];

  function recalc(){
    const spin = Number(spinEl.value);
    const vals = colEls.map(s => Number(s.value));
    const total = vals.reduce((a,b)=>a+b,0);
    const twos = vals.filter(v=>v===2).length;

    // simple “2x present helps” bump (keeps floor-check feel)
    const baseReq = REQUIRED_BY_SPIN[clamp(spin,0,9)];
    const req = Math.max(0, baseReq - (twos >= 1 ? 1 : 0));

    totalEl.textContent = String(total);
    twosEl.textContent = String(twos);
    reqEl.textContent = String(req);

    if (total >= req){
      setResult(out, "AP ✅", "r-green");
      detail.textContent = `Total ${total} ≥ Required ${req} (spin ${spin}${twos?`, ${twos} column(s)=2 helps`:``}).`;
    } else {
      setResult(out, "Not in range", "r-red");
      detail.textContent = `Need ${req - total} more to reach Required ${req} (spin ${spin}${twos?`, ${twos} column(s)=2 helps`:``}).`;
    }
  }

  spinEl.addEventListener("change", recalc);
  colEls.forEach(el => el.addEventListener("change", recalc));
  recalc();
})();
</script>
</body>
</html>
